<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE artifacts>

<artifacts>
	<artifact name="persistenceData2">
		<set var="menuItemUrl" value="br.com.concepting.framework.model.util.ModelUtil.getUrlByModel(#{clazz})"/>
		<set var="menuItemUrl" value="@{menuItemUrl}.concat('.ui?action=init&amp;forward=index')"/>
		<set var="menuItemName" value="menuUserAdmin"/>
		<set var="groupsPropertyInfo" value="#{declaration}.getPropertyInfo('groups')"/>
		<set var="groupModelInfo" value="br.com.concepting.framework.model.util.ModelUtil.getInfo(@{groupsPropertyInfo.collectionItemsClass})"/>
		<set var="objectsPropertyInfo" value="@{groupModelInfo}.getPropertyInfo('objects')"/>
		<set var="objectModelInfo" value="br.com.concepting.framework.model.util.ModelUtil.getInfo(@{objectsPropertyInfo.collectionItemsClass})"/>
		insert into @{openQuote}@{objectModelInfo.mappedRepositoryId}@{closeQuote} (id, type, formId, name, title, description, tooltip, action, actionTarget, objectId, sequence) select 2, 'MENU_ITEM', 1, '@{menuItemName}', '#{ui}', '', '', '@{menuItemUrl}', '', 1, 1 where not exists (select 1 from @{openQuote}@{objectModelInfo.mappedRepositoryId}@{closeQuote} where id = 2);
		
		insert into @{openQuote}@{objectsPropertyInfo.mappedRelationRepositoryId}@{closeQuote} (objectId, groupId) select 2, 1 where not exists (select 1 from @{openQuote}@{objectsPropertyInfo.mappedRelationRepositoryId}@{closeQuote} where objectId = 2 and groupId = 1);
	</artifact>
</artifacts>